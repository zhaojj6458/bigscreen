## 目标
- 彻底梳理三份CSV的字段结构、数据类型、取值特征与质量问题
- 为后续前端数据可视化与统计分析提供干净一致的结构定义

## 已掌握的文件结构
### 周期统计确认(25年11月).csv
- 路径：[周期统计确认(25年11月).csv](file:///c:/Users/HP/Desktop/TR数据大屏3/周期统计确认(25年11月).csv)
- 字段（按列顺序）：
  1. 三包流水号（string，例如 MAZ25-3763/MBY25-3748）
  2. 总部制造发运时间（number，天，含小数）
  3. 总部审核处置时间（number，天，含小数）
  4. 分公司审核提交时间（number，天，含小数）
  5. 补充调查时间（number/空）
  6. 分公司现场调查时间（number/空）
  7. 发运时间（datetime，格式如 2025/11/20 16:00）
  8. 全周期统计时间（number，总时长）
  9. 提出部门（string，分公司名称）
  10. 客户名称（string）
  11. 末列未命名字段（string，取值为“基板/非基板/#N/A”，建议命名为“产品类型”或“类别”）
- 质量与结构问题：
  - 表头末尾多一个逗号导致最后一列无列名
  - 存在负数时长（示例：-0.21/-0.85），需验证计算逻辑
  - 多列为空值；“发运时间”格式统一但其余列混合空值
  - 文件末尾存在合计/公式行（232-234 行），含 #REF!，应在导入时排除
  - 个别客户名称疑似被分隔符影响出现截断，需统一转义或包裹

### MESE三包日志人员节点.csv / MESE三包日志人员节点1229.csv
- 路径：
  - [MESE三包日志人员节点.csv](file:///c:/Users/HP/Desktop/TR数据大屏3/MESE三包日志人员节点.csv)
  - [MESE三包日志人员节点1229.csv](file:///c:/Users/HP/Desktop/TR数据大屏3/MESE三包日志人员节点1229.csv)
- 当前状态：内容以“二进制”形式呈现，可能为非 UTF-8 编码（如 GBK/ANSI）或由 Excel 导出包含特殊 BOM/分隔符，需先做编码检测与转换后再解析结构

## 拟定清洗与结构化方案
1. 编码与分隔符处理
   - 检测并统一两份 MESE 文件编码为 UTF-8；确认分隔符（逗号/分号/制表符）并一致化
2. 列名与模式定义
   - 为“周期统计确认”第11列补充规范列名（例如“产品类型”）
   - 为三文件建立字段字典（列名、数据类型、允许值/范围、是否可空）
3. 异常与汇总行处理
   - 过滤末尾非数据行（含合计与 #REF!）
   - 标注并处理负数时长；明确业务含义（提前/校正）
4. 数据类型强校验
   - 时间列统一解析为日期时间；时长列强制为数值（空值用 null）
   - “产品类型”标准化为枚举：基板/非基板/未知
5. 结果产物
   - 输出三份“结构说明书”（Markdown/JSON Schema）与样例数据预览
   - 提供前端可直接消费的干净 CSV/JSON，保证图表组件可用

## 执行步骤
- 第1步：读取两份 MESE 文件的原始字节，检测编码与分隔符
- 第2步：转换为 UTF-8 并解析首行表头，列出完整字段
- 第3步：为三份文件分别生成字段字典与数据质量报告
- 第4步：输出清洗后的数据与结构化说明，回传审阅

## 需要确认的命名细节（如无特别要求将按默认处理）
- 周期统计确认的第11列命名：默认使用“产品类型”
- 负数时长的业务解释：默认标注为异常并保留原值，另提供派生字段（abs 时长）供图表选择